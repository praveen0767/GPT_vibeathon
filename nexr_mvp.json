{
    "files": {
        "backend/server.js": "const express = require('express');\nconst cors = require('cors');\nconst http = require('http');\nconst WebSocket = require('ws');\nconst multer = require('multer');\nconst upload = multer({ dest: 'uploads/' });\n\nconst app = express();\napp.use(cors());\napp.use(express.json());\n\nconst server = http.createServer(app);\nconst wss = new WebSocket.Server({ server });\n\nconst clients = new Map();\n\nwss.on('connection', (ws) => {\n    ws.on('message', (message) => {\n        const data = JSON.parse(message);\n        if (data.type === 'REGISTER' && data.reportId) {\n            clients.set(data.reportId, ws);\n        }\n    });\n});\n\nconst simulateUpdates = (reportId) => {\n    const steps = ['Request Received', 'Preparing', 'Team Dispatched', 'On the Way', 'Action in Progress', 'Resolved'];\n    let i = 0;\n    const interval = setInterval(() => {\n        if (i >= steps.length) {\n            clearInterval(interval);\n            return;\n        }\n        const ws = clients.get(reportId);\n        if (ws && ws.readyState === WebSocket.OPEN) {\n            ws.send(JSON.stringify({ status: steps[i] }));\n        }\n        i++;\n    }, 3000);\n};\n\napp.post('/report', upload.single('media'), (req, res) => {\n    const { description, lat, long } = req.body;\n    \n    // AI Logic (Heuristic)\n    const keywords = {\n        'fire': 'Fire', 'smoke': 'Fire', 'burn': 'Fire',\n        'injur': 'Ambulance', 'blood': 'Ambulance', 'pain': 'Ambulance',\n        'thief': 'Police', 'gun': 'Police', 'fight': 'Police'\n    };\n    \n    let types = new Set();\n    const descLower = (description || '').toLowerCase();\n    Object.keys(keywords).forEach(k => {\n        if (descLower.includes(k)) types.add(keywords[k]);\n    });\n    if (types.size === 0) types.add('General Assistance');\n\n    // Severity Logic\n    let severity = 'Medium';\n    if (descLower.includes('critical') || descLower.includes('dying') || descLower.includes('severe')) severity = 'Critical';\n    else if (descLower.includes('hurt') || descLower.includes('attack')) severity = 'High';\n\n    const reportId = Date.now().toString();\n\n    const response = {\n        reportId,\n        timestamp: new Date().toISOString(),\n        emergency_type: Array.from(types),\n        severity,\n        location: `${lat || 0},${long || 0}`,
        incident_summary: `AI Agent detected ${Array.from(types).join('/')
        } situation. Immediate dispatch requested.`\n
    };\n\n    simulateUpdates(reportId);\n    res.json(response);\n
});\n\nserver.listen(3001, () => console.log('Backend running on 3001'));","backend/package.json": "{\n  \"name\": \"nexr-backend\",\n  \"version\": \"1.0.0\",\n  \"main\": \"server.js\",\n  \"scripts\": {\n    \"start\": \"node server.js\"\n  },\n  \"dependencies\": {\n    \"cors\": \"^2.8.5\",\n    \"express\": \"^4.18.2\",\n    \"multer\": \"^1.4.5-lts.1\",\n    \"ws\": \"^8.13.0\"\n  }\n}",
"frontend/package.json": "{\n  \"name\": \"nexr-frontend\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"dependencies\": {\n    \"react\": \"^18.2.0\",\n    \"react-dom\": \"^18.2.0\",\n    \"react-scripts\": \"5.0.1\"\n  },\n  \"scripts\": {\n    \"start\": \"react-scripts start\",\n    \"build\": \"react-scripts build\"\n  },\n  \"eslintConfig\": {\n    \"extends\": [\n      \"react-app\",\n      \"react-app/jest\"\n    ]\n  },\n  \"browserslist\": {\n    \"production\": [\n      \">0.2%\",\n      \"not dead\",\n      \"not op_mini all\"\n    ],\n    \"development\": [\n      \"last 1 chrome version\",\n      \"last 1 firefox version\",\n      \"last 1 safari version\"\n    ]\n  }\n}",
"frontend/public/index.html": "<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n    <title>NexR - Emergency Response</title>\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n  </head>\n  <body>\n    <noscript>You need to enable JavaScript to run this app.</noscript>\n    <div id=\"root\"></div>\n  </body>\n</html>",
"frontend/src/index.js": "import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport App from './App';\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);",
"frontend/src/App.js": "import React, { useState } from 'react';\n\nexport default function App() {\n  const [desc, setDesc] = useState('');\n  const [loc, setLoc] = useState(null);\n  const [report, setReport] = useState(null);\n  const [status, setStatus] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  const getLocation = () => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition((pos) => {\n        setLoc({ lat: pos.coords.latitude, long: pos.coords.longitude });\n      });\n    } else {\n      alert(\"Geolocation not supported\");\n    }\n  };\n\n  const submit = async () => {\n    if (!desc && !loc) return alert(\"Please provide description or location\");\n    setLoading(true);\n    const formData = new FormData();\n    formData.append('description', desc);\n    if(loc) {\n        formData.append('lat', loc.lat);\n        formData.append('long', loc.long);\n    }\n    \n    try {\n      const res = await fetch('http://localhost:3001/report', {\n        method: 'POST',
        body: formData\n
});\n      const data = await res.json();\n      setReport(data);\n      setLoading(false);\n\n      const ws = new WebSocket('ws: //localhost:3001');\n      ws.onopen = () => ws.send(JSON.stringify({ type: 'REGISTER', reportId: data.reportId }));\n      ws.onmessage = (e) => setStatus(JSON.parse(e.data).status);\n    } catch (e) {
      console.error(e);
      setLoading(false);
      alert(\"Failed to send report\");\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-900 text-white font-sans p-6 flex flex-col items-center justify-center\">\n      <div className=\"w-full max-w-md bg-slate-800 p-8 rounded-2xl shadow-2xl border border-slate-700\">\n        <h1 className=\"text-4xl font-extrabold text-red-500 mb-8 text-center tracking-tighter\">NexR Emergency</h1>\n        \n        {!report ? (\n          <div className=\"space-y-6\">\n            <div className=\"relative\">\n              <textarea \n                className=\"w-full p-4 bg-slate-900 rounded-xl border border-slate-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none text-lg transition-all\"\n                placeholder=\"Describe the emergency here...\"\n                rows=\"4\"\n                value={desc}\n                onChange={e => setDesc(e.target.value)}\n              />\n            </div>\n            <div className=\"flex gap-4\">\n               <button \n                onClick={getLocation} \n                className={`flex-1 py-3 px-4 rounded-xl font-bold flex items-center justify-center gap-2 transition-all ${loc ? 'bg-green-600 text-black' : 'bg-slate-700 hover:bg-slate-600'}`}\n              >\n                <span>{loc ? 'üìç Location Locked' : 'üìç Capture Location'}</span>\n              </button>\n            </div>\n            {loc && <p className=\"text-xs text-gray-500 text-center\">{loc.lat}, {loc.long}</p>}\n            \n            <button \n              onClick={submit} \n              disabled={loading} \n              className=\"w-full py-4 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 rounded-xl font-black text-xl shadow-lg ring-4 ring-transparent active:ring-red-900/50 transition-all\"\n            >\n              {loading ? (\n                <span className=\"animate-pulse\">CONNECTING TO HQ...</span>\n              ) : (\n                'üö® REPORT EMERGENCY'\n              )}\n            </button>\n          </div>\n        ) : (\n          <div className=\"space-y-6 animate-in fade-in zoom-in duration-300\">\n            <div className=\"bg-red-900/20 p-6 rounded-xl border border-red-500/50 text-center\">\n              <h2 className=\"text-2xl font-bold text-red-400 mb-2\">ALERT DISPATCHED</h2>\n              <div className=\"text-sm text-red-200/60 font-mono\">ID: {report.reportId}</div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4 text-center\">\n               <div className=\"bg-slate-900 p-3 rounded-lg\">\n                  <div className=\"text-gray-400 text-xs uppercase font-bold\">Type</div>\n                  <div className=\"text-lg font-bold\">{report.emergency_type.join(', ')}</div>\n               </div>\n               <div className=\"bg-slate-900 p-3 rounded-lg\">\n                  <div className=\"text-gray-400 text-xs uppercase font-bold\">Severity</div>\n                  <div className=\"text-lg font-bold text-red-500\">{report.severity}</div>\n               </div>\n            </div>\n\n            <div className=\"space-y-4 pt-4 border-t border-slate-700\">\n              <h3 className=\"font-bold text-gray-400 uppercase text-xs tracking-widest text-center\">Live Operations Status</h3>\n              <div className=\"relative overflow-hidden p-6 bg-slate-900 rounded-xl text-center text-3xl font-black tracking-tight text-green-400 border border-green-500/30 shadow-[0_0_30px_rgba(74,222,128,0.1)]\">\n                <div className=\"absolute inset-0 bg-green-500/5 animate-pulse\"></div>\n                <span className=\"relative z-10\">{status || 'INITIATING...'}</span>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}",
"docker-compose.yml": "version: '3.8'\nservices:\n  backend:\n    build: ./backend\n    ports:\n      - \"3001:3001\"\n    environment:\n      - PORT=3001\n  frontend:\n    build: ./frontend\n    ports:\n      - \"3000:3000\"\n    stdin_open: true\n    tty: true\n    depends_on:\n      - backend",
"backend/Dockerfile": "FROM node:18-alpine\nWORKDIR /app\nCOPY package*.json ./\nRUN npm install\nCOPY . .\nEXPOSE 3001\nCMD [\"npm\", \"start\"]",
"frontend/Dockerfile": "FROM node:18-alpine\nWORKDIR /app\nCOPY package*.json ./\nRUN npm install\nCOPY . .\nEXPOSE 3000\nCMD [\"npm\", \"start\"]"
},
"run_instructions": "npm install in both dirs then npm start",
"test_commands": [
"curl -X POST http://localhost:3001/report -H 'Content-Type: application/json' -d '{\"description\":\"Car accident with fire\", \"lat\":12.97, \"long\":77.59}'"
],
"demo_screenshots": null
}